---
title: "A MCEM approach to phylogenetic trees reconstruction"
date: "November 25, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Stop reading :)

This document is work in progress, it will be ready soon. 


# The reconstruction process


```{r echo=FALSE, include=FALSE}
library(dmea)

```
### Introduction 

We are interested on studing macro-evolutionary drivers given a phylogenetic tree


```{r echo=FALSE}
# complete/incomplete trees
comp = '((AB:1,(AA:0.6,AD:0.3):0.4):1,((AE:0.6,AF:0.8):0.2,AC:1.5):0.5):1;'
comp= read.tree(text = comp)
plot(comp,show.tip.label = T, root.edge = TRUE)
```

However, we normally do not see extinct species

```{r echo=FALSE}
incomp = drop.fossil(comp)
plot(incomp,show.tip.label = T, root.edge = TRUE)
```


to infer information from incomplete trees we analyze them as a 'missing-data problem'. Thus, we performs an EM-algorithm 

### EM algorithm

The Em algorithm consists on two steps:

  1. E- step 
  
  $$ E_M[l_{D,M}(\beta)|D,\beta^*] $$

  2. M-step 
  
  $$ \beta^{**} = max_\beta Q(\beta | \beta^*) $$
  
However, there is no close-form of the equation on the E-step in the phylogenetic tree context. An alternative to it is to calculate $E_M[l_{D,M}(\beta)|D,\beta^*]$ via monte-carlo method. 

### MCEM 

In order to use the monte-carlo method we need to simulate reconstructed trees...







